{"id":"953db39d-2b3a-482a-9183-31ffcf599bc1","data":{"nodes":[{"id":"Data-WYWqa","type":"genericNode","position":{"x":139,"y":50.296875},"data":{"type":"Data","node":{"template":{"code":{"type":"code","required":true,"placeholder":"","list":false,"show":true,"multiline":true,"value":"from typing import Optional\nfrom langflow import CustomComponent\nfrom langchain.llms.bedrock import Bedrock\nfrom langchain.llms.base import BaseLLM\n\n\nclass AmazonBedrockComponent(CustomComponent):\n    display_name: str = \"Amazon Bedrock\"\n    description: str = \"LLM model from Amazon Bedrock.\"\n\n    def build_config(self):\n        return {\n            \"model_id\": {\n                \"display_name\": \"Model Id\",\n                \"options\": [\n                    \"ai21.j2-grande-instruct\",\n                    \"ai21.j2-jumbo-instruct\",\n                    \"ai21.j2-mid\",\n                    \"ai21.j2-mid-v1\",\n                    \"ai21.j2-ultra\",\n                    \"ai21.j2-ultra-v1\",\n                    \"anthropic.claude-instant-v1\",\n                    \"anthropic.claude-v1\",\n                    \"anthropic.claude-v2:1\",\n                    \"cohere.command-text-v14\",\n                ],\n            },\n            \"credentials_profile_name\": {\"display_name\": \"Credentials Profile Name\"},\n            \"streaming\": {\"display_name\": \"Streaming\", \"field_type\": \"bool\"},\n            \"code\": {\"show\": False},\n        }\n\n    def build(\n        self,\n        model_id: str = \"anthropic.claude-instant-v1\",\n        credentials_profile_name: Optional[str] = \"default\",\n    ) -> BaseLLM:\n        try:\n            output = Bedrock(\n                credentials_profile_name=credentials_profile_name,\n                model_id=model_id,\n            )  # type: ignore\n        except Exception as e:\n            raise ValueError(\"Could not connect to AmazonBedrock API.\") from e\n        return output","fileTypes":[],"file_path":"","password":false,"name":"code","advanced":false,"dynamic":true,"info":"","title_case":true},"credentials_profile_name":{"type":"str","required":false,"placeholder":"","list":false,"show":true,"multiline":false,"value":"default","fileTypes":[],"file_path":"","password":false,"name":"credentials_profile_name","display_name":"Credentials Profile Name","advanced":false,"dynamic":false,"info":"","title_case":true},"model_id":{"type":"str","required":true,"placeholder":"","list":true,"show":true,"multiline":false,"value":"anthropic.claude-v2:1","fileTypes":[],"file_path":"","password":false,"options":["ai21.j2-grande-instruct","ai21.j2-jumbo-instruct","ai21.j2-mid","ai21.j2-mid-v1","ai21.j2-ultra","ai21.j2-ultra-v1","anthropic.claude-instant-v1","anthropic.claude-v1","anthropic.claude-v2:1","cohere.command-text-v14"],"name":"model_id","display_name":"Model Id","advanced":false,"dynamic":false,"info":"","title_case":true},"_type":"CustomComponent"},"description":"LLM model from Amazon Bedrock.","base_classes":["BaseLanguageModel","BaseLLM"],"display_name":"Amazon Bedrock","documentation":"","custom_fields":{"model_id":null,"credentials_profile_name":null},"output_types":["BaseLLM"],"field_formatters":{},"beta":true},"id":"Data-WYWqa","description":"LLM model from Amazon Bedrock.","display_name":"Amazon Bedrock"},"selected":false,"width":384,"height":465,"dragging":false,"positionAbsolute":{"x":139,"y":50.296875}},{"id":"Data-9DWmT","type":"genericNode","position":{"x":-306.2147557094228,"y":111.32710580214041},"data":{"type":"Data","node":{"template":{"attribute_filter":{"type":"code","required":false,"placeholder":"","list":false,"show":true,"multiline":false,"fileTypes":[],"file_path":"","password":false,"name":"attribute_filter","display_name":"Attribute Filter","advanced":false,"dynamic":false,"info":"","title_case":true,"value":"{\n    \"EqualsTo\": {\n        \"Key\": \"_language_code\",\n        \"Value\": {\"StringValue\": \"ja\"},\n    }\n}"},"code":{"type":"code","required":true,"placeholder":"","list":false,"show":true,"multiline":true,"value":"from typing import Optional\nfrom langflow import CustomComponent\nfrom langchain.retrievers import AmazonKendraRetriever\nfrom langchain.schema import BaseRetriever\n\n\nclass AmazonKendraRetrieverComponent(CustomComponent):\n    display_name: str = \"Amazon Kendra Retriever\"\n    description: str = \"Retriever that uses the Amazon Kendra API.\"\n\n    def build_config(self):\n        return {\n            \"index_id\": {\"display_name\": \"Index ID\"},\n            \"region_name\": {\"display_name\": \"Region Name\"},\n            \"credentials_profile_name\": {\"display_name\": \"Credentials Profile Name\"},\n            \"attribute_filter\": {\n                \"display_name\": \"Attribute Filter\",\n                \"field_type\": \"code\",\n            },\n            \"top_k\": {\"display_name\": \"Top K\", \"field_type\": \"int\"},\n            \"user_context\": {\n                \"display_name\": \"User Context\",\n                \"field_type\": \"code\",\n            },\n            \"code\": {\"show\": False},\n        }\n\n    def build(\n        self,\n        index_id: str,\n        top_k: int = 3,\n        region_name: Optional[str] = None,\n        credentials_profile_name: Optional[str] = \"default\",\n        attribute_filter: Optional[dict] = None,\n        user_context: Optional[dict] = None,\n    ) -> BaseRetriever:\n        try:\n            output = AmazonKendraRetriever(\n                index_id=index_id,\n                top_k=top_k,\n                region_name=region_name,\n                credentials_profile_name=credentials_profile_name,\n                attribute_filter=attribute_filter,\n                user_context=user_context,\n            )  # type: ignore\n        except Exception as e:\n            raise ValueError(\"Could not connect to AmazonKendra API.\") from e\n        return output","fileTypes":[],"file_path":"","password":false,"name":"code","advanced":false,"dynamic":true,"info":"","title_case":true},"credentials_profile_name":{"type":"str","required":false,"placeholder":"","list":false,"show":true,"multiline":false,"value":"default","fileTypes":[],"file_path":"","password":false,"name":"credentials_profile_name","display_name":"Credentials Profile Name","advanced":false,"dynamic":false,"info":"","title_case":true},"index_id":{"type":"str","required":true,"placeholder":"","list":false,"show":true,"multiline":false,"fileTypes":[],"file_path":"","password":false,"name":"index_id","display_name":"Index ID","advanced":false,"dynamic":false,"info":"","title_case":true,"value":""},"region_name":{"type":"str","required":false,"placeholder":"","list":false,"show":true,"multiline":false,"fileTypes":[],"file_path":"","password":false,"name":"region_name","display_name":"Region Name","advanced":false,"dynamic":false,"info":"","title_case":true},"top_k":{"type":"int","required":true,"placeholder":"","list":false,"show":true,"multiline":false,"value":3,"fileTypes":[],"file_path":"","password":false,"name":"top_k","display_name":"Top K","advanced":false,"dynamic":false,"info":"","title_case":true},"user_context":{"type":"code","required":false,"placeholder":"","list":false,"show":true,"multiline":false,"fileTypes":[],"file_path":"","password":false,"name":"user_context","display_name":"User Context","advanced":false,"dynamic":false,"info":"","title_case":true},"_type":"CustomComponent"},"description":"Retriever that uses the Amazon Kendra API.","base_classes":["BaseRetriever"],"display_name":"Amazon Kendra Retriever","documentation":"","custom_fields":{"index_id":null,"top_k":null,"region_name":null,"credentials_profile_name":null,"attribute_filter":null,"user_context":null},"output_types":["BaseRetriever"],"field_formatters":{},"beta":true},"id":"Data-9DWmT","description":"Retriever that uses the Amazon Kendra API.","display_name":"Amazon Kendra Retriever"},"selected":true,"width":384,"height":821,"dragging":false,"positionAbsolute":{"x":-306.2147557094228,"y":111.32710580214041}},{"id":"CombineDocsChain-qkzbp","type":"genericNode","position":{"x":745.932580181263,"y":320.1120503496781},"data":{"type":"CombineDocsChain","node":{"template":{"llm":{"type":"BaseLanguageModel","required":true,"placeholder":"","list":false,"show":true,"multiline":false,"value":"","fileTypes":[],"file_path":"","password":false,"name":"llm","display_name":"LLM","advanced":false,"dynamic":false,"info":"","title_case":true},"chain_type":{"type":"str","required":true,"placeholder":"","list":true,"show":true,"multiline":false,"value":"stuff","fileTypes":[],"file_path":"","password":false,"options":["stuff","map_reduce","map_rerank","refine"],"name":"chain_type","advanced":false,"dynamic":false,"info":"","title_case":true},"_type":"load_qa_chain"},"description":"Load question answering chain.","base_classes":["BaseCombineDocumentsChain","Callable"],"display_name":"CombineDocsChain","documentation":"","custom_fields":{},"output_types":[],"field_formatters":{},"beta":false},"id":"CombineDocsChain-qkzbp"},"selected":false,"width":384,"height":333},{"id":"RetrievalQA-rt34v","type":"genericNode","position":{"x":1271.8697991721635,"y":543.1094312018199},"data":{"type":"RetrievalQA","node":{"template":{"combine_documents_chain":{"type":"BaseCombineDocumentsChain","required":true,"placeholder":"","list":false,"show":true,"multiline":false,"fileTypes":[],"file_path":"","password":false,"name":"combine_documents_chain","display_name":"Combine Documents Chain","advanced":false,"dynamic":false,"info":"","title_case":true},"memory":{"type":"BaseMemory","required":false,"placeholder":"","list":false,"show":true,"multiline":false,"fileTypes":[],"file_path":"","password":false,"name":"memory","display_name":"Memory","advanced":false,"dynamic":false,"info":"","title_case":true},"retriever":{"type":"BaseRetriever","required":true,"placeholder":"","list":false,"show":true,"multiline":false,"fileTypes":[],"file_path":"","password":false,"name":"retriever","display_name":"Retriever","advanced":false,"dynamic":false,"info":"","title_case":true},"code":{"type":"code","required":true,"placeholder":"","list":false,"show":true,"multiline":true,"value":"from typing import Callable, Optional, Union\n\nfrom langchain.chains.combine_documents.base import BaseCombineDocumentsChain\nfrom langchain.chains.retrieval_qa.base import BaseRetrievalQA, RetrievalQA\nfrom langflow import CustomComponent\nfrom langflow.field_typing import BaseMemory, BaseRetriever\n\n\nclass RetrievalQAComponent(CustomComponent):\n    display_name = \"RetrievalQA\"\n    description = \"Chain for question-answering against an index.\"\n\n    def build_config(self):\n        return {\n            \"combine_documents_chain\": {\"display_name\": \"Combine Documents Chain\"},\n            \"retriever\": {\"display_name\": \"Retriever\"},\n            \"memory\": {\"display_name\": \"Memory\", \"required\": False},\n            \"input_key\": {\"display_name\": \"Input Key\", \"advanced\": True},\n            \"output_key\": {\"display_name\": \"Output Key\", \"advanced\": True},\n            \"return_source_documents\": {\"display_name\": \"Return Source Documents\"},\n        }\n\n    def build(\n        self,\n        combine_documents_chain: BaseCombineDocumentsChain,\n        retriever: BaseRetriever,\n        memory: Optional[BaseMemory] = None,\n        input_key: str = \"query\",\n        output_key: str = \"result\",\n        return_source_documents: bool = True,\n    ) -> Union[BaseRetrievalQA, Callable]:\n        return RetrievalQA(\n            combine_documents_chain=combine_documents_chain,\n            retriever=retriever,\n            memory=memory,\n            input_key=input_key,\n            output_key=output_key,\n            return_source_documents=return_source_documents,\n        )\n","fileTypes":[],"file_path":"","password":false,"name":"code","advanced":false,"dynamic":true,"info":"","title_case":true},"input_key":{"type":"str","required":true,"placeholder":"","list":false,"show":true,"multiline":false,"value":"query","fileTypes":[],"file_path":"","password":false,"name":"input_key","display_name":"Input Key","advanced":true,"dynamic":false,"info":"","title_case":true},"output_key":{"type":"str","required":true,"placeholder":"","list":false,"show":true,"multiline":false,"value":"result","fileTypes":[],"file_path":"","password":false,"name":"output_key","display_name":"Output Key","advanced":true,"dynamic":false,"info":"","title_case":true},"return_source_documents":{"type":"bool","required":true,"placeholder":"","list":false,"show":true,"multiline":false,"value":true,"fileTypes":[],"file_path":"","password":false,"name":"return_source_documents","display_name":"Return Source Documents","advanced":false,"dynamic":false,"info":"","title_case":true},"_type":"CustomComponent"},"description":"Chain for question-answering against an index.","base_classes":["BaseRetrievalQA","Chain","Callable"],"display_name":"RetrievalQA","documentation":"","custom_fields":{"combine_documents_chain":null,"retriever":null,"memory":null,"input_key":null,"output_key":null,"return_source_documents":null},"output_types":["BaseRetrievalQA","Callable"],"field_formatters":{},"beta":true},"id":"RetrievalQA-rt34v"},"selected":false,"width":384,"height":501,"positionAbsolute":{"x":1271.8697991721635,"y":543.1094312018199},"dragging":false}],"edges":[{"source":"Data-WYWqa","sourceHandle":"{œbaseClassesœ:[œBaseLanguageModelœ,œBaseLLMœ],œdataTypeœ:œDataœ,œidœ:œData-WYWqaœ}","target":"CombineDocsChain-qkzbp","targetHandle":"{œfieldNameœ:œllmœ,œidœ:œCombineDocsChain-qkzbpœ,œinputTypesœ:null,œtypeœ:œBaseLanguageModelœ}","data":{"targetHandle":{"fieldName":"llm","id":"CombineDocsChain-qkzbp","inputTypes":null,"type":"BaseLanguageModel"},"sourceHandle":{"baseClasses":["BaseLanguageModel","BaseLLM"],"dataType":"Data","id":"Data-WYWqa"}},"style":{"stroke":"#555"},"className":"stroke-foreground  stroke-connection","animated":false,"id":"reactflow__edge-Data-WYWqa{œbaseClassesœ:[œBaseLanguageModelœ,œBaseLLMœ],œdataTypeœ:œDataœ,œidœ:œData-WYWqaœ}-CombineDocsChain-qkzbp{œfieldNameœ:œllmœ,œidœ:œCombineDocsChain-qkzbpœ,œinputTypesœ:null,œtypeœ:œBaseLanguageModelœ}"},{"source":"CombineDocsChain-qkzbp","sourceHandle":"{œbaseClassesœ:[œBaseCombineDocumentsChainœ,œCallableœ],œdataTypeœ:œCombineDocsChainœ,œidœ:œCombineDocsChain-qkzbpœ}","target":"RetrievalQA-rt34v","targetHandle":"{œfieldNameœ:œcombine_documents_chainœ,œidœ:œRetrievalQA-rt34vœ,œinputTypesœ:null,œtypeœ:œBaseCombineDocumentsChainœ}","data":{"targetHandle":{"fieldName":"combine_documents_chain","id":"RetrievalQA-rt34v","inputTypes":null,"type":"BaseCombineDocumentsChain"},"sourceHandle":{"baseClasses":["BaseCombineDocumentsChain","Callable"],"dataType":"CombineDocsChain","id":"CombineDocsChain-qkzbp"}},"style":{"stroke":"#555"},"className":"stroke-foreground  stroke-connection","animated":false,"id":"reactflow__edge-CombineDocsChain-qkzbp{œbaseClassesœ:[œBaseCombineDocumentsChainœ,œCallableœ],œdataTypeœ:œCombineDocsChainœ,œidœ:œCombineDocsChain-qkzbpœ}-RetrievalQA-rt34v{œfieldNameœ:œcombine_documents_chainœ,œidœ:œRetrievalQA-rt34vœ,œinputTypesœ:null,œtypeœ:œBaseCombineDocumentsChainœ}"},{"source":"Data-9DWmT","sourceHandle":"{œbaseClassesœ:[œBaseRetrieverœ],œdataTypeœ:œDataœ,œidœ:œData-9DWmTœ}","target":"RetrievalQA-rt34v","targetHandle":"{œfieldNameœ:œretrieverœ,œidœ:œRetrievalQA-rt34vœ,œinputTypesœ:null,œtypeœ:œBaseRetrieverœ}","data":{"targetHandle":{"fieldName":"retriever","id":"RetrievalQA-rt34v","inputTypes":null,"type":"BaseRetriever"},"sourceHandle":{"baseClasses":["BaseRetriever"],"dataType":"Data","id":"Data-9DWmT"}},"style":{"stroke":"#555"},"className":"stroke-foreground  stroke-connection","animated":false,"id":"reactflow__edge-Data-9DWmT{œbaseClassesœ:[œBaseRetrieverœ],œdataTypeœ:œDataœ,œidœ:œData-9DWmTœ}-RetrievalQA-rt34v{œfieldNameœ:œretrieverœ,œidœ:œRetrievalQA-rt34vœ,œinputTypesœ:null,œtypeœ:œBaseRetrieverœ}"}],"viewport":{"x":255.16027148124556,"y":2.477922368398822,"zoom":0.7259791399519471}},"description":"Promptly Ingenious!","name":"example3","last_tested_version":"0.6.7","is_component":false}